name: SharePoint OneDrive
description: |
  Monitors SharePoint/OneDrive to submit their content to GLIMPS Malware Detect and remediate if malware is detected.
mitigation_info_type: "file"
setup_steps:
  - name: Create App Registration
    description: |
      Follow the attached guide to create your app registration. This will allow the connector to communicate with Microsoft Graph API.
    files:
      - odsp_app_registration_guide.pdf

  - name: Select monitoring mode
    description: |
      The connector has two monitoring modes :

      1. **Periodic monitoring**: Regularly checks for changes in drives, using a configurable frequency.
      2. **Real-time monitoring**: Creates webhooks with Microsoft Graph API to receive notifications when changes occur in drives.
         Microsoft needs a publicly available address that serves on https.

      -> The first mode is mandatory, the second is optional.

      -> These two modes are not mutually exclusive but complementary. The second mode allows for better optimization of the connector's responsiveness without querying Graph API too often.

      The first mode is configurable via `MonitoringFrequency`, the second via `RealTimeMonitoring` and `WebhookURL`.

  - name: Choose mitigation action
    description: |
      Choose action to perform on files detected as malware :

      - **Quarantine** : move malware files to quarantine site (requires quarantine configuration with `QuarantineURL`, `QuarantineLibName` and `QuarantineDeleteMalwareOnMSDetection`).
      - **Delete** : permanently deletes malware files.
      - **Log** : Log malware detections (in connector manager's logs). Files detected as malware are left untouched.

      Note: only one action can (and must) be selected.

  - name: Choose monitoring scope
    description: |
      You can choose between two monitoring scopes :

      - **Monitor All** : every drive in your tenant (for all sites & groups) will be monitored. To select this mode, select either `MonitorAllWithoutInitialScan` or `MonitorAllWithInitialScan`.
        You can exclude specific sites or groups with the fields `SitesToIgnore` and `GroupsToIgnore`.
      - **Monitor Selected** : only monitor given sites and groups. To select this mode, you must unselect `MonitorAllWithoutInitialScan` and `MonitorAllWithInitialScan` and fill one of the following fields : `SitesToMonitorWithoutInitialScan`, `SitesToMonitorWithInitialScan`, `GroupsToMonitorWithoutInitialScan` or `GroupsToMonitorWithInitialScan`.

      **Initial Scan**: analyze initial content at connector start. Otherwise, only new changes are analyzed.
        How it works: for each drive to monitor, a dedicated process is started, with a limit of 20 concurrent initial scans.

launch_steps:
